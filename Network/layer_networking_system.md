# 네트워크 계층별 장비의 데이터 전송방법

> Hub - 1계층

**Hub**는 OSI 1계층으로 따로 주소를 가지지 않는다.

Hub는 _Physical_ 의 영역으로 모든 정보를 _Flooding_(플러딩) 방식으로 전달하기 때문에 주소나 경로DB를 가질 필요가 없다.

> Switch - 2계층

**Switch** 는 2계층으로 _Mac Address_ 를 보고 경로를 정한다.

전송방식은 _Forwarding_(포워딩)과 _Flooding_(플러딩)을 사용한다.

수신자의 _Mac Address_ 를 보고 경로DB(_Mac Address Table_)에 존재할 경우 _Forwarding_ 방식으로 목적지에 바로 정보를 전송한다. 

경로DB에 출구번호가 존재하지 않을 경우 _Flooding_ 방식으로 모든 출구에 정보를 전송한다.

> Router - 3계층

**Router**는 3계층으로 _IP_ 를 보고 경로를 정한다.

전송방식은 _Forwarding_(포워딩) 뿐이다.

수신자의 _IP_ 를 보고 경로DB(_Routing Table_)에 존재할경우 _Forwarding_ 방식으로 목적지에 바로 정보를 전송한다.

경로DB에 출구번호가 존재하지 않을 경우 출구를 찾지않고 **전송실패**를 _Reply_ 한다.

네트워크에서 **전송실패**란 유쾌한 상황이 아니기 때문에 이 부분을 유심히 볼 필요가 있다.

## Router에서의 전송실패 - Media Translation

데이터를 전송시에는
- 전송데이터
-  송신자,수신자의 Port
-  송신자,수신자의 IP Address
-  송신자,수신자의 Mac Address   

총 7개의 정보가 필요하다.

여기서 데이터는 송신측에서 설정하고, Port의 경우는 _Well-Known Port_ 를 사용하여 어느정도 약속된 규약이 있어 문제가 없다.

문제는 수신측의 **IP**와 **Mac Address**이다.

네트워크 서버 접속을 예로 들면 우리는 www로 시작하는 _도메인주소_ 만 으로 웹사이트 서버에 접속한다.

이때 도메인주소를 사용하여 _DNS Server_ 의 도움을 받아 수신자의 _IP_ 주소를 가져올 수 있다.    

    DNS에 대한 자세한 내용은 다른 노트에..

하지만 외부망과 연결할 때 수신자의 _Mac Address_ 를 적어 데이터를 보낸다면 라우터에서는 그 정보를 본인 정보로 받지않고 폐기 해 버린다. 이때 사용되는 기술이 **_Media Translation_** 이다. 

클라이언트는 라우터의 _Mac Address_ 를 _ARP_ 를 통해 알아내어 수신자 _Mac Address_ 로 입력해 보낸다. 

    ARP에 대한 자세한 내용은 다른 노트에..

이렇게 보내면 라우터는 그 정보를 받아 _IP_ 가 가야할 길에 있는 또 다른 라우터의 _Mac Address_ 를 받아 그 주소를 수신자 _Mac Address_ 에 적어 보낸다. 이 과정을 통해 클라이언트는 외부망의 서버에 접속할 수 있다.

이렇게 보면 굉장히 복잡해 보이지만 장점이 명확하다.
+ 이 과정은 한 번 만 이루어진다.
  + 복잡한 과정을 거친 후 _DNS Cache_,  _ARP Cache_ 에 정보가 저장되기 때문에 빠르게 통신을 이어나갈 수 있다.
+ 클라이언트 입장에서 편하다
  + 클라이언트는 굳이 서버의 _Mac Address_ 까지 알 필요없이 라우터의 주소만 알면 되기 때문에 정보측면에서는 더 간결해진다.

---

따라서 정리하자면 클라이언트가 외부망과 통신하기 위해서는 


- 전송데이터
-  송신자,수신자의 Port
-  송신자,수신자의 IP Address
-  송신자,수신자의 Mac Address 
  
의 정보가 필요하다.

 또한  라우터에 각 _IP_ 에 도달하기 위한 경로가 세팅돼있어야 한다.